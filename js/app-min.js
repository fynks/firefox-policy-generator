let extensionsToInstall=["https://addons.mozilla.org/firefox/downloads/latest/ublock-origin/latest.xpi","https://addons.mozilla.org/firefox/downloads/latest/bitwarden-password-manager/latest.xpi","https://addons.mozilla.org/firefox/downloads/latest/multi-account-containers/latest.xpi"],searchEngines=[{name:"G",url:"https://www.google.com/search?q={searchTerms}",alias:"!g"},{name:"Brave",url:"https://search.brave.com/search?q={searchTerms}",alias:"!b"},{name:"Startpage",url:"https://www.startpage.com/do/search?q={searchTerms}",alias:"!s"},{name:"DuckDuckGo",url:"https://duckduckgo.com/?q={searchTerms}",alias:"!ddg"},{name:"YouTube",url:"https://www.youtube.com/results?search_query={searchTerms}",alias:"!yt"}],currentPolicy={};function init(){updateExtensionList(),updateSearchEngineList(),generatePolicy(),showSuccessMessage(),document.querySelectorAll("input, select").forEach((e=>{e.addEventListener("change",(()=>{generatePolicy(),showSuccessMessage()})),e.addEventListener("input",(()=>{generatePolicy(),showSuccessMessage()}))}))}function generatePolicy(){const e={"__COMMENT__ More Information":"https://github.com/mozilla/policy-templates/blob/master/README.md","__COMMENT__ Generated":`Firefox Policy Generator - ${(new Date).toISOString()}`,policies:{}};document.getElementById("dontCheckDefaultBrowser").checked&&(e.policies.DontCheckDefaultBrowser=!0),document.getElementById("disableFeedbackCommands").checked&&(e.policies.DisableFeedbackCommands=!0),document.getElementById("disableFirefoxAccounts").checked&&(e.policies.DisableFirefoxAccounts=!0),document.getElementById("disableFirefoxStudies").checked&&(e.policies.DisableFirefoxStudies=!0),document.getElementById("disableTelemetry").checked&&(e.policies.DisableTelemetry=!0),document.getElementById("disableAppUpdate").checked&&(e.policies.DisableAppUpdate=!0);const t=document.getElementById("displayBookmarksToolbar").value;"always"!==t&&(e.policies.DisplayBookmarksToolbar=t),document.getElementById("disablePasswordReveal").checked&&(e.policies.DisablePasswordReveal=!0);const n=document.getElementById("homepageURL").value,o=document.getElementById("startPage").value,s=document.getElementById("newTabURL").value;(n||"none"!==o)&&(e.policies.Homepage={},n&&(e.policies.Homepage.URL=n),"none"!==o&&(e.policies.Homepage.StartPage=o),e.policies.Homepage.Locked=!1),s&&(e.policies.NewTabPage=!1,e.policies.OverrideFirstRunPage=s),e.policies.FirefoxHome={Search:document.getElementById("homeSearch").checked,TopSites:document.getElementById("homeTopSites").checked,Highlights:document.getElementById("homeHighlights").checked,SponsoredPocket:!1,Snippets:!1,Locked:!1},document.getElementById("noDefaultBookmarks").checked&&(e.policies.NoDefaultBookmarks=!0),document.getElementById("offerToSaveLogins").checked||(e.policies.OfferToSaveLogins=!1),document.getElementById("disableFormHistory").checked&&(e.policies.DisableFormHistory=!0),document.getElementById("disablePasswordManager").checked&&(e.policies.PasswordManagerEnabled=!1),document.getElementById("trackingProtection").checked&&(e.policies.EnableTrackingProtection={Value:!0,Locked:!1,Cryptomining:!0,Fingerprinting:!0}),e.policies.FirefoxSuggest={WebSuggestions:document.getElementById("webSuggestions").checked,SponsoredSuggestions:document.getElementById("sponsoredSuggestions").checked,ImproveSuggest:!0,Locked:!1};const i=document.getElementById("dnsOverHttps").value;if("default"!==i)if("disabled"===i)e.policies.DNSOverHTTPS={Enabled:!1,Locked:!0};else{const t={cloudflare:"https://mozilla.cloudflare-dns.com/dns-query",quad9:"https://dns.quad9.net/dns-query"};e.policies.DNSOverHTTPS={Enabled:!0,ProviderURL:t[i],Locked:!0}}extensionsToInstall.length>0&&(e.policies.Extensions={Install:extensionsToInstall,Uninstall:["google@search.mozilla.org","bing@search.mozilla.org","amazondotcom@search.mozilla.org","ebay@search.mozilla.org","twitter@search.mozilla.org","wikipedia@search.mozilla.org"]}),document.getElementById("blockExtensionInstall").checked&&(e.policies.InstallAddonsPermission={Allow:[],Default:!1}),searchEngines.length>0&&(e.policies.SearchEngines={Default:document.getElementById("defaultSearchEngine").value,Add:searchEngines.map((e=>({Name:e.name,URLTemplate:e.url,Alias:e.alias,Method:"GET"}))),PreventInstalls:document.getElementById("preventSearchEngineInstalls").checked,Remove:["Google","Bing","Amazon.com","eBay","Twitter","Wikipedia"]});"strict"===document.getElementById("contentBlocking").value&&(e.policies.EnableTrackingProtection={Value:!0,Locked:!0,Cryptomining:!0,Fingerprinting:!0}),document.getElementById("blockDangerousDownloads").checked&&(e.policies.DisableBuiltinPDFViewer=!1),document.getElementById("blockUncommonDownloads").checked&&(e.policies.DownloadRestrictions={ApplicationZip:!1,Executable:!1}),document.getElementById("disableWebRTC").checked&&(e.policies.WebRTCIPHandlingPolicy="disable_non_proxied_udp"),e.policies.OverrideFirstRunPage="",e.policies.OverridePostUpdatePage="",e.policies.DisableSetDesktopBackground=!0,e.policies.DisableBuiltinPDFViewer=!1,e.policies.BlockAboutConfig=!1,currentPolicy=e}function showSuccessMessage(){const e=document.getElementById("successMessage");e.classList.add("show"),setTimeout((()=>{e.classList.remove("show")}),3e3)}function addExtension(e){const t=document.getElementById("newExtensionURL"),n=t.value.trim();n&&("install"===e&&(extensionsToInstall.push(n),updateExtensionList()),t.value="",generatePolicy(),showSuccessMessage())}function removeExtension(e,t){const n=e.closest(".extension-item"),o=n.querySelector("span").textContent;if("install"===t){const e=extensionsToInstall.findIndex((e=>e.includes("ublock-origin")&&o.includes("uBlock Origin")||e.includes("bitwarden")&&o.includes("Bitwarden")||e.includes("multi-account-containers")&&o.includes("Multi-Account Containers")));e>-1&&extensionsToInstall.splice(e,1)}else if("search"===t){const e=searchEngines.findIndex((e=>o.includes(e.name)));e>-1&&searchEngines.splice(e,1)}n.remove(),generatePolicy(),showSuccessMessage()}function updateExtensionList(){const e=document.getElementById("extensionInstallList");e.innerHTML="",extensionsToInstall.forEach((t=>{const n=document.createElement("div");n.className="extension-item";let o="Custom Extension";t.includes("ublock-origin")?o="uBlock Origin - Ad & Tracker Blocker":t.includes("bitwarden")?o="Bitwarden - Password Manager":t.includes("multi-account-containers")&&(o="Multi-Account Containers - Isolation"),n.innerHTML=`\n                    <span>${o}</span>\n                    <button class="btn btn-danger" onclick="removeExtension(this, 'install')">Remove</button>\n                `,e.appendChild(n)}))}function updateSearchEngineList(){const e=document.getElementById("searchEngineList");e.innerHTML="",searchEngines.forEach((t=>{const n=document.createElement("div");n.className="extension-item";const o=`${t.name}${t.alias?" ("+t.alias+")":""}`;n.innerHTML=`\n                    <span>${o}</span>\n                    <button class="btn btn-danger" onclick="removeExtension(this, 'search')">Remove</button>\n                `,e.appendChild(n)}))}function showOS(e){document.querySelectorAll(".os-tab").forEach((e=>e.classList.remove("active"))),document.querySelectorAll(".os-content").forEach((e=>e.classList.remove("active"))),event.target.classList.add("active"),document.getElementById(e).classList.add("active")}function copyToClipboard(e){const t=JSON.stringify(currentPolicy,null,2);navigator.clipboard.writeText(t).then((()=>{const t=e||("undefined"!=typeof event?event.target:null);if(t){const e=t.textContent;t.textContent="Copied!",setTimeout((()=>{t.textContent=e}),2e3)}}))}function downloadPolicy(){const e=JSON.stringify(currentPolicy,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="policies.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}document.addEventListener("DOMContentLoaded",init);