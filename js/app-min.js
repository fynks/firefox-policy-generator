let extensionsToInstall=["https://addons.mozilla.org/firefox/downloads/latest/ublock-origin/latest.xpi","https://addons.mozilla.org/firefox/downloads/latest/bitwarden-password-manager/latest.xpi","https://addons.mozilla.org/firefox/downloads/latest/multi-account-containers/latest.xpi"],searchEngines=[{name:"G",url:"https://www.google.com/search?q={searchTerms}",alias:"!g"},{name:"Brave",url:"https://search.brave.com/search?q={searchTerms}",alias:"!b"},{name:"Startpage",url:"https://www.startpage.com/do/search?q={searchTerms}",alias:""},{name:"YouTube",url:"https://www.youtube.com/results?search_query={searchTerms}",alias:"!yt"}],currentPolicy={};function init(){generatePolicy(),showSuccessMessage(),document.querySelectorAll("input, select").forEach((e=>{e.addEventListener("change",(()=>{generatePolicy(),showSuccessMessage()})),e.addEventListener("input",(()=>{generatePolicy(),showSuccessMessage()}))}))}function generatePolicy(){const e={"__COMMENT__ More Information":"https://github.com/mozilla/policy-templates/blob/master/README.md",policies:{}};document.getElementById("dontCheckDefaultBrowser").checked&&(e.policies.DontCheckDefaultBrowser=!0),document.getElementById("disableFeedbackCommands").checked&&(e.policies.DisableFeedbackCommands=!0),document.getElementById("disableFirefoxAccounts").checked&&(e.policies.DisableFirefoxAccounts=!0),document.getElementById("disableFirefoxScreenshots").checked&&(e.policies.DisableFirefoxScreenshots=!0),document.getElementById("disableFirefoxStudies").checked&&(e.policies.DisableFirefoxStudies=!0),document.getElementById("disableTelemetry").checked&&(e.policies.DisableTelemetry=!0);const t=document.getElementById("displayBookmarksToolbar").value;"always"!==t&&(e.policies.DisplayBookmarksToolbar=t);const o=document.getElementById("displayMenuBar").value;"default-on"!==o&&(e.policies.DisplayMenuBar=o),document.getElementById("disableDeveloperTools").checked&&(e.policies.DisableDeveloperTools=!0);const n=document.getElementById("homepageURL").value,s=document.getElementById("startPage").value;(n||"none"!==s)&&(e.policies.Homepage={},n&&(e.policies.Homepage.URL=n),"none"!==s&&(e.policies.Homepage.StartPage=s),e.policies.Homepage.Locked=!1),e.policies.FirefoxHome={Search:document.getElementById("homeSearch").checked,TopSites:document.getElementById("homeTopSites").checked,SponsoredTopSites:document.getElementById("homeSponsoredTopSites").checked,Highlights:document.getElementById("homeHighlights").checked,Pocket:document.getElementById("homePocket").checked,SponsoredPocket:!1,Snippets:!1,Locked:!1},document.getElementById("noDefaultBookmarks").checked&&(e.policies.NoDefaultBookmarks=!0),document.getElementById("offerToSaveLogins").checked||(e.policies.OfferToSaveLogins=!1),e.policies.FirefoxSuggest={WebSuggestions:document.getElementById("webSuggestions").checked,SponsoredSuggestions:document.getElementById("sponsoredSuggestions").checked,ImproveSuggest:!0,Locked:!1},extensionsToInstall.length>0&&(e.policies.Extensions={Install:extensionsToInstall,Uninstall:["google@search.mozilla.org","bing@search.mozilla.org","amazondotcom@search.mozilla.org","ebay@search.mozilla.org","twitter@search.mozilla.org","wikipedia@search.mozilla.org"]}),searchEngines.length>0&&(e.policies.SearchEngines={Default:document.getElementById("defaultSearchEngine").value,Add:searchEngines.map((e=>({Name:e.name,URLTemplate:e.url,Alias:e.alias,Method:"GET"}))),PreventInstalls:!1,Remove:["Google","Bing","Amazon.com","eBay","Twitter","Wikipedia"]}),e.policies.OverrideFirstRunPage="",e.policies.OverridePostUpdatePage="",e.policies.DisableSetDesktopBackground=!0,currentPolicy=e}function showSuccessMessage(){const e=document.getElementById("successMessage");e.classList.add("show"),setTimeout((()=>{e.classList.remove("show")}),3e3)}function addExtension(e){const t=document.getElementById("newExtensionURL"),o=t.value.trim();o&&("install"===e&&(extensionsToInstall.push(o),updateExtensionList()),t.value="",generatePolicy(),showSuccessMessage())}function removeExtension(e,t){const o=e.closest(".extension-item"),n=o.querySelector("span").textContent;if("install"===t){const e=extensionsToInstall.findIndex((e=>e.includes("ublock-origin")&&n.includes("uBlock Origin")||e.includes("bitwarden")&&n.includes("Bitwarden")||e.includes("multi-account-containers")&&n.includes("Multi-Account Containers")));e>-1&&extensionsToInstall.splice(e,1)}else if("search"===t){const e=searchEngines.findIndex((e=>n.includes(e.name)));e>-1&&searchEngines.splice(e,1)}o.remove(),generatePolicy(),showSuccessMessage()}function updateExtensionList(){const e=document.getElementById("extensionInstallList");e.innerHTML="",extensionsToInstall.forEach((t=>{const o=document.createElement("div");o.className="extension-item";let n="Custom Extension";t.includes("ublock-origin")?n="uBlock Origin":t.includes("bitwarden")?n="Bitwarden":t.includes("multi-account-containers")&&(n="Multi-Account Containers"),o.innerHTML=`\n                    <span>${n}</span>\n                    <button class="btn btn-danger" onclick="removeExtension(this, 'install')">Remove</button>\n                `,e.appendChild(o)}))}function showOS(e){document.querySelectorAll(".os-tab").forEach((e=>e.classList.remove("active"))),document.querySelectorAll(".os-content").forEach((e=>e.classList.remove("active"))),event.target.classList.add("active"),document.getElementById(e).classList.add("active")}function copyToClipboard(){const e=JSON.stringify(currentPolicy,null,2);navigator.clipboard.writeText(e).then((()=>{const e=event.target,t=e.textContent;e.textContent="Copied!",setTimeout((()=>{e.textContent=t}),2e3)}))}function downloadPolicy(){const e=JSON.stringify(currentPolicy,null,2),t=new Blob([e],{type:"application/json"}),o=URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.download="policies.json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o)}document.addEventListener("DOMContentLoaded",init);